<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Typo Royale</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 2rem; }
    #lobby, #game, #scores { margin-top: 2rem; display: none; }
    input, button, select { padding: 0.5rem; margin: 0.5rem; }
    #sentence { font-size: 1.2rem; margin: 1rem 0; }
  </style>
</head>
<body>
  <h1>Typo Royale</h1>

  <div id="setup">
    <input id="nameInput" placeholder="Enter Your Name" />
    <button onclick="createRoom()">Create Room</button>
    <input id="roomInput" placeholder="Enter Room Code" />
    <button onclick="joinRoom()">Join Room</button>
  </div>

  <div id="lobby">
    <h2>Room: <span id="roomCode"></span></h2>
    <p>Players:</p>
    <ul id="playerList"></ul>
    <label for="roundSelect">Rounds:</label>
    <select id="roundSelect">
      <option value="1">1</option>
      <option value="3">3</option>
      <option value="5">5</option>
    </select>
    <button onclick="startGame()">Start Game</button>
  </div>

  <div id="game">
    <div id="roundInfo"></div>
    <div id="sentence"></div>
    <input id="typingInput" placeholder="Type here..." oninput="checkInput()" />
  </div>

  <div id="scores">
    <h2>Scores</h2>
    <ul id="scoreList"></ul>
  </div>

  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <script>
    const socket = io('https://typo-royale-server.onrender.com'); // Replace with your actual Render URL
    let roomId = '';
    let sentence = '';
    let startTime = null;
    let playerName = '';
    let currentRound = 1;
    let totalRounds = 1;

    function createRoom() {
      playerName = document.getElementById('nameInput').value.trim();
      if (!playerName) return alert("Please enter your name");
      roomId = generateRoomCode();
      document.getElementById('roomCode').textContent = roomId;
      socket.emit('createRoom', roomId);
      socket.emit('joinRoom', roomId, playerName);
      show('lobby');
    }

    function joinRoom() {
      playerName = document.getElementById('nameInput').value.trim();
      if (!playerName) return alert("Please enter your name");
      roomId = document.getElementById('roomInput').value.toUpperCase();
      document.getElementById('roomCode').textContent = roomId;
      socket.emit('joinRoom', roomId, playerName);
      show('lobby');
    }

    function startGame() {
      totalRounds = parseInt(document.getElementById('roundSelect').value);
      currentRound = 1;
      socket.emit('startGame', roomId, totalRounds);
    }

    socket.on('roomUpdate', (players) => {
      const list = document.getElementById('playerList');
      list.innerHTML = '';
      players.forEach(p => {
        const li = document.createElement('li');
        li.textContent = p.name || p.id;
        list.appendChild(li);
      });
    });

    socket.on('gameStarted', ({ sentence: text, round, total }) => {
      sentence = text;
      currentRound = round;
      totalRounds = total;
      document.getElementById('roundInfo').textContent = `Round ${round} of ${total}`;
      document.getElementById('sentence').textContent = sentence;
      document.getElementById('typingInput').value = '';
      startTime = Date.now();
      show('game');
    });

    function checkInput() {
      const input = document.getElementById('typingInput').value;
      if (input === sentence) {
        const timeTaken = (Date.now() - startTime) / 1000;
        const score = Math.round(1000 / timeTaken);
        socket.emit('submitScore', { roomId, score });
        show('scores');
      }
    }

    socket.on('scoreUpdate', (players) => {
      const list = document.getElementById('scoreList');
      list.innerHTML = '';
      players.forEach(p => {
        const li = document.createElement('li');
